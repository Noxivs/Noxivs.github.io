<!DOCTYPE html>
<html>
    <head>

      <style>
        .mask {
          display: none;
        }

        .compass_container {
          position: fixed;
          top: 0;
          left: 0;
          width: 100vw;
          height: 100vh;
          z-index: 1;
        }

        body {
          height: 3000px;
        }
      </style>
    </head>
    <body>
      <div class="compass_container">
        <img id="compass_src" src="background.jpg" class="mask" data-mask="skate.png">
        <canvas id="compass"></canvas>
      </div>
      <script src="jquery-3.1.1.min.js"></script>
      <script>
        const TO_RADIANS = Math.PI/180;
        window.requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame ||
                              window.webkitRequestAnimationFrame || window.msRequestAnimationFrame;


        let start = null;

        let imageCanvas = document.getElementById("compass");
        let imageContext = imageCanvas.getContext('2d');
        let imageSource = document.getElementById("compass_src");

        let background = null;
        let mask = null;

        let rotate = 0;

        background = document.createElement('img');
        background.src = imageSource.src;

        background.onload = function() {

            let width  = background.width;
            let height = background.height;

            imageCanvas.width = width;
            imageCanvas.height = height

            mask = document.createElement('img');
            mask.src = imageSource.getAttribute('data-mask');

            mask.onload = function() {

              function drawCanvas(timestamp) {
                requestAnimationFrame(drawCanvas);

                imageCanvas.width = width;
                imageCanvas.height = height;

                imageContext.clearRect(0, 0, width, height);

                imageContext.save();

                imageContext.translate(width/2, height/2);
                imageContext.rotate(rotate * TO_RADIANS);
                imageContext.drawImage(mask, -(mask.width/2),  -(mask.height/2), mask.width, mask.height);

                imageContext.restore();

                imageContext.globalCompositeOperation = 'source-atop';

                imageContext.drawImage(background, 0,0, width, height);
              }

              requestAnimationFrame(drawCanvas);
            };
        };


        $( window ).scroll(function() {
          rotate += 10;
          $('html, body').animate({scrollTop: '0px'}, 0);
        });
      </script>
    </body>
</html>
